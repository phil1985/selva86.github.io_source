<h2>Ggplot Tutorial - Part 3: Top 50 Ggplot2 Visualizations - The Master List</h2>
<blockquote>
<p>What type of visualization to use for what sort of problem? This matters whenever the results of data analysis needs to be presented. This article provides guidelines to help you choose the right type of chart for your specific objectives. So when someone sees the plot, they instantly get it.</p>
</blockquote>
<p>This is part 3 of a three part tutorial on ggplot2, an aesthetically pleasing (and very popular) graphics framework in R. This tutorial is primarily geared towards those having some basic knowledge of the R programming language and want to make complex and nice looking charts with R ggplot.</p>
<ul>
<li><p><a href="ggplot2-r-Tutorial-Part1.html">Part 1: Introduction to Ggplot</a>, covers the basic knowledge about constructing simple ggplots and modifying the components and aesthetics.</p></li>
<li><p><a href="ggplot2-r-Tutorial-Part2.html">Part 2: Customizing the Look and Feel</a>, is about more advanced customizations like manipulating legend, annotations, multiplots with faceting and custom layouts</p></li>
<li><p><a href="ggplot2-r-Tutorial-Part3.html">Part 3: Top 50 Ggplot2 Visualizations - The Master List</a>, applies what was learnt in part 1 and 2 to construct other types of ggplots such as bar charts, boxplots etc.</p></li>
</ul>
<h3><a name="top"></a>Top 50 Ggplot2 Visualizations - The Master List</h3>
<p>An effective chart is one that:</p>
<ul>
<li>Conveys the right information without distorting facts.</li>
<li>Is simple but elegant. It should not force you to think much in order to get it.</li>
<li>Aesthetics supports information rather that overshadow it.</li>
<li>Is not overloaded with information.</li>
</ul>
<ol style="list-style-type: decimal">
<li><a href="ggplot2-r-Tutorial-Part3.html#1.%20Correlation">Correlation</a>
<ul>
<li><a href="ggplot2-r-Tutorial-Part3.html#Scatterplot">Scatterplot</a></li>
<li><a href="#Scatterplot%20With%20Encircling">Scatterplot With Encircling</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Jitter%20Plot">Jitter Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Counts%20Chart">Counts Chart</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Bubble%20Plot">Bubble Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Animated%20Bubble%20Plot">Animated Bubble Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Marginal%20Histogram%20/%20Boxplot">Marginal Histogram / Boxplot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Correlogram">Correlogram</a></li>
</ul></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#2.%20Deviation">Deviation</a>
<ul>
<li><a href="ggplot2-r-Tutorial-Part3.html#Diverging%20Bars">Diverging Bars</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Diverging%20Lollipop%20Chart">Diverging Lollipop Chart</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Diverging%20Dot%20Plot">Diverging Dot Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Area%20Chart">Area Chart</a></li>
</ul></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#3.%20Ranking">Ranking</a>
<ul>
<li><a href="ggplot2-r-Tutorial-Part3.html#Ordered%20Bar%20Chart">Ordered Bar Chart</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Lollipop%20Chart">Lollipop Chart</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Dot%20Plot">Dot Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Slope%20Chart">Slope Chart</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Dumbbell%20Plot">Dumbbell Plot</a></li>
</ul></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#4.%20Distribution">Distribution</a>
<ul>
<li><a href="ggplot2-r-Tutorial-Part3.html#Histogram">Histogram</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Density%20Plot">Density Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Box%20Plot">Box Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Dot%20+%20Box%20Plot">Dot + Box Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Tufte%20Boxplot">Tufte Boxplot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Violin%20Plot">Violin Plot</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Population%20Pyramid">Population Pyramid</a></li>
</ul></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#5.%20Composition">Composition</a>
<ul>
<li><a href="#Waffle%20Chart">Waffle Chart</a></li>
<li><a href="#Pie%20Chart">Pie Chart</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Treemap">Treemap</a></li>
<li><a href="#Bar%20Chart">Bar Chart</a></li>
</ul></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#6.%20Change">Change</a>
<ul>
<li><a href="#Time%20Series%20Plots">Time Series Plots</a></li>
<li><a href="#Stacked%20Area%20Chart">Stacked Area Chart</a></li>
<li><a href="#Calendar%20Heat%20Map">Calendar Heat Map</a></li>
<li><a href="#Slope%20Chart">Slope Chart</a></li>
<li><a href="#Seasonal%20Plot">Seasonal Plot</a></li>
</ul></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#7.%20Groups">Groups</a>
<ul>
<li><a href="#Hierarchical%20Dendrogram">Dendrogram</a></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#Clusters">Clusters</a></li>
</ul></li>
<li><a href="ggplot2-r-Tutorial-Part3.html#8.%20Spatial">Spatial</a>
<ul>
<li><a href="#Open%20Street%20Map">Open Street Map</a></li>
<li><a href="#Google%20Road%20Map">Google Road Map</a></li>
<li><a href="#Google%20Hybrid%20Map">Google Hybrid Map</a></li>
</ul></li>
</ol>
<h2>1. Correlation</h2>
<h3><a name="Scatterplot"></a>Scatterplot</h3>
<p>The most frequently used plot for data analysis is undoubtedly the scatterplot. Whenever you want to understand the nature of relationship between two variables, invariably the first choice is the scatterplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load package and data</span>
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())  <span class="co"># pre-set the bw theme.</span>
<span class="kw">options</span>(<span class="dt">scipen=</span><span class="dv">999</span>)  <span class="co"># turn-off scientific notation like 1e+48</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(<span class="st">&quot;midwest&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;ggplot2&quot;</span>)
<span class="co"># midwest &lt;- read.csv(&quot;http://goo.gl/G1K41K&quot;)  # bkup data source</span>

<span class="co"># Scatterplot</span>
gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(midwest, <span class="kw">aes</span>(<span class="dt">x=</span>area, <span class="dt">y=</span>poptotal)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col=</span>state, <span class="dt">size=</span>popdensity)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>, <span class="dt">se=</span>F) +<span class="st"> </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)) +<span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">500000</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle=</span><span class="st">&quot;Area Vs Population&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Population&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Area&quot;</span>, <span class="dt">title=</span><span class="st">&quot;Scatterplot&quot;</span>, <span class="dt">caption =</span> <span class="st">&quot;Source: midwest&quot;</span>)

<span class="kw">plot</span>(gg)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_1.png" alt="Ggplot Scatterplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<p>When presenting the results, sometimes I would encirlce certain points or regions in the chart so as to draw the attention to those particular cases. But how to make a curve that goes around the points/regions of interest?</p>
<p>This can be conveniently done using the <code>geom_encircle()</code> in <code>ggalt</code> package. Just set the <code>data</code> to a new dataframe that contains only the points (rows) or interest. You can <code>expand</code> the curve so as to pass just outside the points. The <code>color</code> and <code>size</code> (thickness) of the curve can be modified as well. See below example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install &#39;ggalt&#39; pkg</span>
<span class="co"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span>
<span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">999</span>)
<span class="kw">library</span>(ggalt)
midwest_select &lt;-<span class="st"> </span>midwest[midwest$poptotal &gt;<span class="st"> </span><span class="dv">350000</span> &amp;<span class="st"> </span>midwest$poptotal &lt;=<span class="st"> </span><span class="dv">500000</span> &amp;<span class="st"> </span>
<span class="st">                     </span>midwest$area &gt;<span class="st"> </span><span class="fl">0.01</span> &amp;<span class="st"> </span>midwest$area &lt;<span class="st"> </span><span class="fl">0.1</span>, ]

<span class="co"># Plot</span>
<span class="kw">ggplot</span>(midwest, <span class="kw">aes</span>(<span class="dt">x=</span>area, <span class="dt">y=</span>poptotal)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">col=</span>state, <span class="dt">size=</span>popdensity)) +<span class="st">   </span><span class="co"># draw points</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;loess&quot;</span>, <span class="dt">se=</span>F) +<span class="st"> </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>)) +<span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">500000</span>)) +<span class="st">   </span><span class="co"># draw smoothing line</span>
<span class="st">  </span><span class="kw">geom_encircle</span>(<span class="kw">aes</span>(<span class="dt">x=</span>area, <span class="dt">y=</span>poptotal), <span class="dt">data=</span>midwest_select, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>, <span class="dt">expand=</span><span class="fl">0.08</span>) +<span class="st">   </span><span class="co"># draw circle</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle=</span><span class="st">&quot;Area Vs Population&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Population&quot;</span>, <span class="dt">x=</span><span class="st">&quot;Area&quot;</span>, 
       <span class="dt">title=</span><span class="st">&quot;Scatterplot + Encircle&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: midwest&quot;</span>)</code></pre></div>
<p><a name="Scatterplot With Encircling"></a> <img src="screenshots/ggplot_masterlist_2.png" alt="Ggplot Scatterplot With Encircling" /> <a href="#top">[Back to Top]</a></p>
<h3><a name="Jitter Plot"></a>Jitter Plot</h3>
<p>Let’s look at new example of scatterplot. But this time, I will use the <code>mpg</code> dataset to plot city mileage (<code>cty</code>) vs highway mileage (<code>hwy</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load package and data</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(mpg, <span class="dt">package=</span><span class="st">&quot;ggplot2&quot;</span>) <span class="co"># alternate source: &quot;http://goo.gl/uEeRGu&quot;)</span>
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())  <span class="co"># pre-set the bw theme.</span>

g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(cty, hwy))

<span class="co"># Scatterplot</span>
g +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span>F) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle=</span><span class="st">&quot;mpg: city vs highway mileage&quot;</span>, <span class="dt">y=</span><span class="st">&quot;hwy&quot;</span>, <span class="dt">x=</span><span class="st">&quot;cty&quot;</span>, 
       <span class="dt">title=</span><span class="st">&quot;Scatterplot with overlapping points&quot;</span>, 
       <span class="dt">caption=</span><span class="st">&quot;Source: midwest&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_3.png" alt="Ggplot Scatterplot With Hidden Data points" /> What we have here is a scatterplot of city and highway mileage in <code>mpg</code> dataset. We have seen a similar scatterplot and this looks neat and gives a clear idea of how the city mileage (<code>cty</code>) and highway mileage (<code>hwy</code>) are well correlated.</p>
<p>But, this innocent looking plot is <em>hiding</em> something. Can you find out?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(mpg)</code></pre></div>
<p>The original data has 234 data points but the chart seems to display fewer points. What has happened? This is because there are many overlapping points appearing as a single dot. The fact that both <code>cty</code> and <code>hwy</code> are integers in the source dataset made it all the more convenient to hide this detail. So just be extra careful the next time you make scatterplot with integers.</p>
<p>So how to handle this? There are few options. We can make a jitter plot with <code>jitter_geom()</code>. As the name suggests, the overlapping points are randomly jittered around its original position based on a threshold controlled by the <code>width</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load package and data</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(mpg, <span class="dt">package=</span><span class="st">&quot;ggplot2&quot;</span>)
<span class="co"># mpg &lt;- read.csv(&quot;http://goo.gl/uEeRGu&quot;)</span>

<span class="co"># Scatterplot</span>
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())  <span class="co"># pre-set the bw theme.</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(cty, hwy))
g +<span class="st"> </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> .<span class="dv">5</span>, <span class="dt">size=</span><span class="dv">1</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle=</span><span class="st">&quot;mpg: city vs highway mileage&quot;</span>, <span class="dt">y=</span><span class="st">&quot;hwy&quot;</span>, <span class="dt">x=</span><span class="st">&quot;cty&quot;</span>, 
       <span class="dt">title=</span><span class="st">&quot;Jittered Points&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_4.png" alt="Ggplot Jitter Plot" /> More points are revealed now. More the <code>width</code>, more the points are moved around from their original position.</p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Counts Chart"></a>Counts chart</h3>
<p>The second option is to use a counts chart. Where ever there more points overlap, the size of the circle gets bigger. I like this one.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load package and data</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(mpg, <span class="dt">package=</span><span class="st">&quot;ggplot2&quot;</span>)
<span class="co"># mpg &lt;- read.csv(&quot;http://goo.gl/uEeRGu&quot;)</span>

<span class="co"># Scatterplot</span>
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())  <span class="co"># pre-set the bw theme.</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(cty, hwy))
g +<span class="st"> </span><span class="kw">geom_count</span>(<span class="dt">col=</span><span class="st">&quot;tomato3&quot;</span>, <span class="dt">show.legend=</span>F) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle=</span><span class="st">&quot;mpg: city vs highway mileage&quot;</span>, <span class="dt">y=</span><span class="st">&quot;hwy&quot;</span>, <span class="dt">x=</span><span class="st">&quot;cty&quot;</span>, 
       <span class="dt">title=</span><span class="st">&quot;Counts Plot&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_5.png" alt="Ggplot Counts Plot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Bubble Plot"></a>Bubble plot</h3>
<p>While scatterplot lets you compare the relationship between 2 continuous variables, bubble chart serves well if you want to understand underlying relationship within groups based on another categorical variable (by changing the color) and another continuous variable (by changing the size of points). In simpler words, bubble charts are more suitable if you have 4-Dimensional data where two of them are numeric (X and Y) and one other categorial (color) and another numeric variable(size).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load package and data</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">data</span>(mpg, <span class="dt">package=</span><span class="st">&quot;ggplot2&quot;</span>)
<span class="co"># mpg &lt;- read.csv(&quot;http://goo.gl/uEeRGu&quot;)</span>

mpg_select &lt;-<span class="st"> </span>mpg[mpg$manufacturer %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;audi&quot;</span>, <span class="st">&quot;ford&quot;</span>, <span class="st">&quot;honda&quot;</span>, <span class="st">&quot;hyundai&quot;</span>), ]

<span class="co"># Scatterplot</span>
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())  <span class="co"># pre-set the bw theme.</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg_select, <span class="kw">aes</span>(displ, cty)) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">subtitle=</span><span class="st">&quot;mpg: Displacement vs City Mileage&quot;</span>, 
                                                <span class="dt">title=</span><span class="st">&quot;Bubble chart&quot;</span>)

g +<span class="st"> </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">col=</span>manufacturer, <span class="dt">size=</span>hwy)) +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">col=</span>manufacturer), <span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span>F)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_6.png" alt="Ggplot Bubble Plot" /></p>
<p>The bubble chart clearly distinguishes the range of <code>displ</code> between the manufacturers and how the slope of lines-of-bestfit varies, providing a better visual comparison between the groups.</p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Animated Bubble Plot"></a>Animated Bubble chart</h3>
<p>An animated bubbel chart can be implemented using the <code>gganimate</code> package. It is same as a bubble chart, but, you have to show how the values change over a fifth dimension (typically time).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Source: https://github.com/dgrtwo/gganimate</span>
<span class="co"># install.packages(&quot;cowplot&quot;)  # a gganimate dependency</span>
<span class="co"># devtools::install_github(&quot;dgrtwo/gganimate&quot;)</span>
<span class="kw">library</span>(gganimate)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(gapminder)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())  <span class="co"># pre-set the bw theme.</span>

g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gapminder, <span class="kw">aes</span>(gdpPercap, lifeExp, <span class="dt">size =</span> pop, <span class="dt">frame =</span> year)) +
<span class="st">  </span><span class="kw">geom_point</span>() +
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">group =</span> year), <span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">show.legend =</span> <span class="ot">FALSE</span>) +
<span class="st">  </span><span class="kw">facet_wrap</span>(~continent, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>) +
<span class="st">  </span><span class="kw">scale_x_log10</span>()  <span class="co"># convert to log scale</span>

<span class="kw">gganimate</span>(g, <span class="dt">interval=</span><span class="fl">0.2</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_7.gif" alt="Ggplot Animated Bubble Plot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Marginal Histogram / Boxplot"></a>Marginal Histogram / Boxplot</h3>
<p>If you want to show the relationship as well as the distribution of the variable, use the marginal histogram. It has a histogram of the X and Y variables at the margins of the scatterplot. This can be implemented using the <code>ggMarginal()</code> function from the ‘<code>ggExtra</code>’ package. Apart from a histogram, you could choose to draw a <code>boxplot</code> or <code>density</code> plot by setting the <code>type</code> option.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load package and data</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggExtra)
<span class="kw">data</span>(mpg, <span class="dt">package=</span><span class="st">&quot;ggplot2&quot;</span>)
<span class="co"># mpg &lt;- read.csv(&quot;http://goo.gl/uEeRGu&quot;)</span>

<span class="co"># Scatterplot</span>
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())  <span class="co"># pre-set the bw theme.</span>
mpg_select &lt;-<span class="st"> </span>mpg[mpg$hwy &gt;=<span class="st"> </span><span class="dv">35</span> &amp;<span class="st"> </span>mpg$cty &gt;<span class="st"> </span><span class="dv">27</span>, ]
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(cty, hwy)) +<span class="st"> </span><span class="kw">geom_count</span>() +<span class="st"> </span>
<span class="st">                                  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span>F)

<span class="kw">ggMarginal</span>(g, <span class="dt">type =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>)
<span class="kw">ggMarginal</span>(g, <span class="dt">type =</span> <span class="st">&quot;boxplot&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;transparent&quot;</span>)
<span class="co"># ggMarginal(g, type = &quot;density&quot;, fill=&quot;transparent&quot;)</span></code></pre></div>
<p><img src="screenshots/ggplot_masterlist_8_1.png" alt="Ggplot Marginal Histogram" /> <br> <br> <img src="screenshots/ggplot_masterlist_8_2.png" alt="Ggplot Marginal Histogram" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Correlogram"></a>Correlogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install_github(&quot;kassambara/ggcorrplot&quot;)</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggcorrplot)

<span class="co"># Correlation matrix</span>
<span class="kw">data</span>(mtcars)
corr &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">cor</span>(mtcars), <span class="dv">1</span>)

<span class="co"># Plot</span>
<span class="kw">ggcorrplot</span>(corr, <span class="dt">hc.order =</span> <span class="ot">TRUE</span>, 
           <span class="dt">type =</span> <span class="st">&quot;lower&quot;</span>, 
           <span class="dt">lab =</span> <span class="ot">TRUE</span>, 
           <span class="dt">lab_size =</span> <span class="dv">3</span>, 
           <span class="dt">method=</span><span class="st">&quot;circle&quot;</span>, 
           <span class="dt">colors =</span> <span class="kw">c</span>(<span class="st">&quot;tomato2&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;springgreen3&quot;</span>), 
           <span class="dt">title=</span><span class="st">&quot;Correlogram of mtcars&quot;</span>, 
           <span class="dt">ggtheme=</span>theme_bw)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_9.png" alt="Ggplot Correlogram" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h2>2. Deviation</h2>
<p>Compare variation in <em>values</em> between small number of categories with respect to a fixed reference. (diverging bar, spine chart, area chart)</p>
<h3><a name="Diverging Bars"></a>Diverging bars</h3>
<p>A bar chart that can handle both negative and positive values. By default, geom_bar() has the <code>stat</code> set to <code>count</code>. That means, when you provide just a continuous X variable (an no Y variable), it tries to make a histogram out of the data.</p>
<p>In order to make a barchart create bars instead of histogram, you need to set <code>stat=identity</code> and provide both <code>x</code> and <code>y</code> inside <code>aes()</code> where, <code>x</code> is either <code>character</code> or <code>factor</code> and <code>y</code> is numeric.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())  

<span class="co"># Data Prep</span>
<span class="kw">data</span>(<span class="st">&quot;mtcars&quot;</span>)  <span class="co"># load data</span>
mtcars$<span class="st">`</span><span class="dt">car name</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">rownames</span>(mtcars)  <span class="co"># create new column for car names</span>
mtcars$mpg_z &lt;-<span class="st"> </span><span class="kw">round</span>((mtcars$mpg -<span class="st"> </span><span class="kw">mean</span>(mtcars$mpg))/<span class="kw">sd</span>(mtcars$mpg), <span class="dv">2</span>)  <span class="co"># compute normalized mpg</span>
mtcars$mpg_type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(mtcars$mpg_z &lt;<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;below&quot;</span>, <span class="st">&quot;above&quot;</span>)  <span class="co"># above / below avg flag</span>
mtcars &lt;-<span class="st"> </span>mtcars[<span class="kw">order</span>(mtcars$mpg_z), ]  <span class="co"># sort</span>
mtcars$<span class="st">`</span><span class="dt">car name</span><span class="st">`</span> &lt;-<span class="st"> </span><span class="kw">factor</span>(mtcars$<span class="st">`</span><span class="dt">car name</span><span class="st">`</span>, <span class="dt">levels =</span> mtcars$<span class="st">`</span><span class="dt">car name</span><span class="st">`</span>)  <span class="co"># convert to factor to retain sorted order in plot.</span>

<span class="co"># Diverging Barcharts</span>
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">car name</span><span class="st">`</span>, <span class="dt">y=</span>mpg_z, <span class="dt">label=</span>mpg_z)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="kw">aes</span>(<span class="dt">fill=</span>mpg_type), <span class="dt">width=</span>.<span class="dv">5</span>)  +
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">name=</span><span class="st">&quot;Mileage&quot;</span>, 
                    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Above Average&quot;</span>, <span class="st">&quot;Below Average&quot;</span>), 
                    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;above&quot;</span>=<span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;below&quot;</span>=<span class="st">&quot;#f8766d&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">subtitle=</span><span class="st">&quot;Normalised mileage from &#39;mtcars&#39;&quot;</span>, <span class="dt">title=</span> <span class="st">&quot;Diverging Bars&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_10.png" alt="Ggplot Diverging Bars" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Diverging Lollipop Chart"></a>Diverging Lollipop Chart</h3>
<p>Lollipop chart conveys the same information as bar chart and diverging bar. Except that it looks more modern. Let’s draw a lollipop using the same data I prepared in the previous example of diverging bars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">car name</span><span class="st">`</span>, <span class="dt">y=</span>mpg_z, <span class="dt">label=</span>mpg_z)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="dt">fill=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">6</span>)  +
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">x =</span> <span class="st">`</span><span class="dt">car name</span><span class="st">`</span>, <span class="dt">yend =</span> mpg_z, <span class="dt">xend =</span> <span class="st">`</span><span class="dt">car name</span><span class="st">`</span>), <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) +
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Diverging Lollipop Chart&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;Normalized mileage from &#39;mtcars&#39;: Lollipop&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylim</span>(-<span class="fl">2.5</span>, <span class="fl">2.5</span>) +
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_11.png" alt="Ggplot Lollipop Plot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Diverging Dot Plot"></a>Diverging Dot Plot</h3>
<p>Dot plot conveys similar information. Below example uses the same data prepared in the diverging bars example.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

<span class="co"># Plot</span>
<span class="kw">ggplot</span>(mtcars, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">car name</span><span class="st">`</span>, <span class="dt">y=</span>mpg_z, <span class="dt">label=</span>mpg_z)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>, <span class="kw">aes</span>(<span class="dt">col=</span>mpg_type), <span class="dt">size=</span><span class="dv">6</span>)  +
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name=</span><span class="st">&quot;Mileage&quot;</span>, 
                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Above Average&quot;</span>, <span class="st">&quot;Below Average&quot;</span>), 
                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;above&quot;</span>=<span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;below&quot;</span>=<span class="st">&quot;#f8766d&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">color=</span><span class="st">&quot;white&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Diverging Dot Plot&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;Normalized mileage from &#39;mtcars&#39;: Dotplot&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylim</span>(-<span class="fl">2.5</span>, <span class="fl">2.5</span>) +
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_12.png" alt="Ggplot Dotplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Area Chart"></a>Area Chart</h3>
<p>How an individual stock performed compared to a baseline</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(quantmod)
<span class="kw">data</span>(<span class="st">&quot;economics&quot;</span>)
<span class="kw">head</span>(economics$pce)
economics$returns_perc &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">diff</span>(economics$psavert)/economics$psavert[-<span class="kw">length</span>(economics$psavert)])

<span class="co"># create break points and labels for axis ticks</span>
brks &lt;-<span class="st"> </span>economics$date[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(economics$date), <span class="dv">12</span>)]
lbls &lt;-<span class="st"> </span>lubridate::<span class="kw">year</span>(economics$date[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(economics$date), <span class="dv">12</span>)])

<span class="co"># plot</span>
<span class="kw">ggplot</span>(economics[<span class="dv">1</span>:<span class="dv">100</span>, ], <span class="kw">aes</span>(date, returns_perc)) +<span class="st"> </span><span class="kw">geom_area</span>() +<span class="st"> </span><span class="kw">scale_x_date</span>(<span class="dt">breaks=</span>brks, <span class="dt">labels=</span>lbls) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">90</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Area Chart&quot;</span>, <span class="dt">subtitle =</span> <span class="st">&quot;Perc Returns for Personal Savings&quot;</span>, <span class="dt">y=</span><span class="st">&quot;% Returns for Personal savings&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: economics&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_13.png" alt="Ggplot Area Chart" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h2>3. Ranking</h2>
<p>Used to compare the position or performance of multiple items with respect to each other. Actual values matters somewhat less than the ranking.</p>
<h3><a name="Ordered Bar Chart"></a>Ordered Bar Chart</h3>
<p>If you want to plot the mean city mileage of each manufacturer, we might first aggregate the data and sort it before you draw the plot. Just sorting the dataframe by the variable of interest isn’t enough to order the bar chart. In order for the barchart to retain the order of the rows, the X axis variable (car names in this case) has to be converted into a factor.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Prepare data: group mean city mileage by manufacturer.</span>
cty_mpg &lt;-<span class="st"> </span><span class="kw">aggregate</span>(mpg$cty, <span class="dt">by=</span><span class="kw">list</span>(mpg$manufacturer), <span class="dt">FUN=</span>mean)  <span class="co"># aggregate</span>
<span class="kw">colnames</span>(cty_mpg) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;make&quot;</span>, <span class="st">&quot;mileage&quot;</span>)  <span class="co"># change column names</span>
cty_mpg &lt;-<span class="st"> </span>cty_mpg[<span class="kw">order</span>(cty_mpg$mileage), ]  <span class="co"># sort</span>
cty_mpg$make &lt;-<span class="st"> </span><span class="kw">factor</span>(cty_mpg$make, <span class="dt">levels =</span> cty_mpg$make)  <span class="co"># to retain the order in plot.</span>
<span class="kw">head</span>(cty_mpg, <span class="dv">4</span>)
<span class="co">#&gt;          make  mileage</span>
<span class="co">#&gt; 9     lincoln 11.33333</span>
<span class="co">#&gt; 8  land rover 11.50000</span>
<span class="co">#&gt; 3       dodge 13.13514</span>
<span class="co">#&gt; 10    mercury 13.25000</span></code></pre></div>
<p>The data is ready, let’s plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

<span class="co"># Draw plot</span>
<span class="kw">ggplot</span>(cty_mpg, <span class="kw">aes</span>(<span class="dt">x=</span>make, <span class="dt">y=</span>mileage)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width=</span>.<span class="dv">5</span>, <span class="dt">fill=</span><span class="st">&quot;tomato3&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Ordered Bar Chart&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Make Vs Avg. Mileage&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;source: mpg&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">65</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>))</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_14.png" alt="Ggplot Ordered Barchart" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Lollipop Chart"></a>Lollipop Chart</h3>
<p>Lollipop charts conveys the same information as in barcharts. By reducing the thick bars to thin lines, it reduces the clutter and lays more emphasis on the value. Looks nice and modern.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

<span class="co"># Plot</span>
<span class="kw">ggplot</span>(cty_mpg, <span class="kw">aes</span>(<span class="dt">x=</span>make, <span class="dt">y=</span>mileage)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>make, <span class="dt">xend=</span>make, <span class="dt">y=</span><span class="dv">0</span>, <span class="dt">yend=</span>mileage)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Lollipop Chart&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Make Vs Avg. Mileage&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;source: mpg&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">65</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>))</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_15.png" alt="Ggplot Lollipop Barchart" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Dot Plot"></a>Dot Plot</h3>
<p>Dot plots are very similar to lollipops, but without the line and is flipped to horizontal position. It emphasizes more on the rank ordering of items with respect to actual values and how far apart are the entities with respect to each other.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(scales)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Plot</span>
<span class="kw">ggplot</span>(cty_mpg, <span class="kw">aes</span>(<span class="dt">x=</span>make, <span class="dt">y=</span>mileage)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">col=</span><span class="st">&quot;tomato2&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>) +<span class="st">   </span><span class="co"># Draw points</span>
<span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>make, <span class="dt">xend=</span>make, <span class="dt">y=</span><span class="kw">min</span>(mileage), <span class="dt">yend=</span><span class="kw">max</span>(mileage)), <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">size=</span><span class="fl">0.1</span>) +<span class="st">   </span><span class="co"># Draw dashed lines</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Dot Plot&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Make Vs Avg. Mileage&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;source: mpg&quot;</span>) +<span class="st">  </span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_16.png" alt="Ggplot Dot Plot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Slope Chart"></a>Slope Chart</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(scales)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># prep data</span>
df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/selva86/datasets/master/gdppercap.csv&quot;</span>)
<span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;continent&quot;</span>, <span class="st">&quot;1952&quot;</span>, <span class="st">&quot;1957&quot;</span>)
left_label &lt;-<span class="st"> </span><span class="kw">paste</span>(df$continent, <span class="kw">round</span>(df$<span class="st">`</span><span class="dt">1952</span><span class="st">`</span>),<span class="dt">sep=</span><span class="st">&quot;, &quot;</span>)
right_label &lt;-<span class="st"> </span><span class="kw">paste</span>(df$continent, <span class="kw">round</span>(df$<span class="st">`</span><span class="dt">1957</span><span class="st">`</span>),<span class="dt">sep=</span><span class="st">&quot;, &quot;</span>)
df$class &lt;-<span class="st"> </span><span class="kw">ifelse</span>((df$<span class="st">`</span><span class="dt">1957</span><span class="st">`</span> -<span class="st"> </span>df$<span class="st">`</span><span class="dt">1952</span><span class="st">`</span>) &lt;<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>)

<span class="co"># Plot</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df) +<span class="st"> </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="dv">1</span>, <span class="dt">xend=</span><span class="dv">2</span>, <span class="dt">y=</span><span class="st">`</span><span class="dt">1952</span><span class="st">`</span>, <span class="dt">yend=</span><span class="st">`</span><span class="dt">1957</span><span class="st">`</span>, <span class="dt">col=</span>class), <span class="dt">size=</span>.<span class="dv">75</span>, <span class="dt">show.legend=</span>F) +<span class="st"> </span>
<span class="st">                  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="dv">1</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">size=</span>.<span class="dv">1</span>) +<span class="st"> </span>
<span class="st">                  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="dv">2</span>, <span class="dt">linetype=</span><span class="st">&quot;dashed&quot;</span>, <span class="dt">size=</span>.<span class="dv">1</span>) +
<span class="st">                  </span><span class="kw">scale_color_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Up&quot;</span>, <span class="st">&quot;Down&quot;</span>), 
                                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>=<span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;red&quot;</span>=<span class="st">&quot;#f8766d&quot;</span>)) +<span class="st">  </span><span class="co"># color of lines</span>
<span class="st">                  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Mean GdpPerCap&quot;</span>) +<span class="st">  </span><span class="co"># Axis labels</span>
<span class="st">                  </span><span class="kw">xlim</span>(.<span class="dv">5</span>, <span class="fl">2.5</span>) +<span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>,(<span class="fl">1.1</span>*(<span class="kw">max</span>(df$<span class="st">`</span><span class="dt">1952</span><span class="st">`</span>, df$<span class="st">`</span><span class="dt">1957</span><span class="st">`</span>))))  <span class="co"># X and Y axis limits</span>

<span class="co"># Add texts</span>
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">label=</span>left_label, <span class="dt">y=</span>df$<span class="st">`</span><span class="dt">1952</span><span class="st">`</span>, <span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">1</span>, <span class="kw">NROW</span>(df)), <span class="dt">hjust=</span><span class="fl">1.1</span>, <span class="dt">size=</span><span class="fl">3.5</span>)
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">label=</span>right_label, <span class="dt">y=</span>df$<span class="st">`</span><span class="dt">1957</span><span class="st">`</span>, <span class="dt">x=</span><span class="kw">rep</span>(<span class="dv">2</span>, <span class="kw">NROW</span>(df)), <span class="dt">hjust=</span>-<span class="fl">0.1</span>, <span class="dt">size=</span><span class="fl">3.5</span>)
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">label=</span><span class="st">&quot;Time 1&quot;</span>, <span class="dt">x=</span><span class="dv">1</span>, <span class="dt">y=</span><span class="fl">1.1</span>*(<span class="kw">max</span>(df$<span class="st">`</span><span class="dt">1952</span><span class="st">`</span>, df$<span class="st">`</span><span class="dt">1957</span><span class="st">`</span>)), <span class="dt">hjust=</span><span class="fl">1.2</span>, <span class="dt">size=</span><span class="dv">5</span>)  <span class="co"># title</span>
p &lt;-<span class="st"> </span>p +<span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">label=</span><span class="st">&quot;Time 2&quot;</span>, <span class="dt">x=</span><span class="dv">2</span>, <span class="dt">y=</span><span class="fl">1.1</span>*(<span class="kw">max</span>(df$<span class="st">`</span><span class="dt">1952</span><span class="st">`</span>, df$<span class="st">`</span><span class="dt">1957</span><span class="st">`</span>)), <span class="dt">hjust=</span>-<span class="fl">0.1</span>, <span class="dt">size=</span><span class="dv">5</span>)  <span class="co"># title</span>

<span class="co"># Minify theme</span>
p +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
           <span class="dt">panel.grid =</span> <span class="kw">element_blank</span>(),
           <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),
           <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
           <span class="dt">panel.border =</span> <span class="kw">element_blank</span>(),
           <span class="dt">plot.margin =</span> <span class="kw">unit</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="st">&quot;cm&quot;</span>))</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_17.png" alt="Ggplot Slope Chart" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Dumbbell Plot"></a>Dumbbell Plot</h3>
<p>Dumbbell charts are a great tool if you wish to: - Visualise relative positions (like growth and decline) between two points in time (1) - Compare distance between two categories. (2)</p>
<p>In order to get the correct ordering of the dumbells, the Y varible should be a factor and the levels of the factor variable should be in the same order as it should appear in the plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggalt)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

health &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/selva86/datasets/master/health.csv&quot;</span>)
health$Area &lt;-<span class="st"> </span><span class="kw">factor</span>(health$Area, <span class="dt">levels=</span><span class="kw">as.character</span>(health$Area))  <span class="co"># for right ordering of the dumbells</span>

<span class="co"># health$Area &lt;- factor(health$Area)</span>
gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(health, <span class="kw">aes</span>(<span class="dt">x=</span>pct_2013, <span class="dt">xend=</span>pct_2014, <span class="dt">y=</span>Area, <span class="dt">group=</span>Area)) +<span class="st"> </span>
<span class="st">        </span><span class="kw">geom_dumbbell</span>(<span class="dt">color=</span><span class="st">&quot;#a3c4dc&quot;</span>, <span class="dt">size=</span><span class="fl">0.75</span>, <span class="dt">point.colour.l=</span><span class="st">&quot;#0e668b&quot;</span>) +<span class="st"> </span>
<span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">label=</span>percent) +<span class="st"> </span>
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="ot">NULL</span>, <span class="dt">y=</span><span class="ot">NULL</span>, <span class="dt">title=</span><span class="st">&quot;Dumbbell Chart&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Pct Change: 2013 vs 2014&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: https://github.com/hrbrmstr/ggalt&quot;</span>) +
<span class="st">        </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>, <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),
              <span class="dt">plot.background=</span><span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),
              <span class="dt">panel.background=</span><span class="kw">element_rect</span>(<span class="dt">fill=</span><span class="st">&quot;#f7f7f7&quot;</span>),
              <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),
              <span class="dt">panel.grid.major.y=</span><span class="kw">element_blank</span>(),
              <span class="dt">panel.grid.major.x=</span><span class="kw">element_line</span>(),
              <span class="dt">axis.ticks=</span><span class="kw">element_blank</span>(),
              <span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>,
              <span class="dt">panel.border=</span><span class="kw">element_blank</span>())
<span class="kw">plot</span>(gg)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_18.png" alt="Ggplot Dumbbell Chart" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h2>4. Distribution</h2>
<p>When you have lots and lots of datapoints and want to study where and how the data points are distributed. <a href="https://github.com/hrbrmstr/ggalt" class="uri">https://github.com/hrbrmstr/ggalt</a></p>
<h3><a name="Histogram"></a>Histogram</h3>
<p>Now, Let’s move on to barchart. By default, if only one variable is supplied, the <code>geom_bar()</code> tries to calculate the count. In order for it to behave like a bar chart, the <code>stat=identity</code> option has to be set and <code>x</code> and <code>y</code> values must be provided.</p>
<h4>Histogram on a continuous variable</h4>
<p>Histogram on a continuous variable can be accomplished using either <code>geom_bar()</code> or <code>geom_histogram()</code>. When using <code>geom_histogram()</code>, you can control the number of bars using the <code>bins</code> option. Else, you can set the range covered by each bin using <code>binwidth</code>. The value of <code>binwidth</code> is on the same scale as the continuous variable on which histogram is built. Since, <code>geom_histogram</code> gives facility to control both number of <code>bins</code> as well as <code>binwidth</code>, it is the preferred option to create histogram on continuous variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Histogram on a Continuous (Numeric) Variable</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(displ)) +<span class="st"> </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Spectral&quot;</span>)

g +<span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>class), <span class="dt">binwidth =</span> .<span class="dv">1</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span>.<span class="dv">1</span>) +<span class="st">  </span><span class="co"># change binwidth</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Histogram with Auto Binning&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Engine Displacement across Vehicle Classes&quot;</span>)   

g +<span class="st"> </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>class), <span class="dt">bins=</span><span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span>.<span class="dv">1</span>) +<span class="st">   </span><span class="co"># change number of bins</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Histogram with Fixed Bins&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Engine Displacement across Vehicle Classes&quot;</span>) </code></pre></div>
<p><img src="screenshots/ggplot_masterlist_19.png" alt="Ggplot Histogram on Numeric Variable" /> <img src="screenshots/ggplot_masterlist_20.png" alt="Ggplot Histogram with 5 Bins - Spectral" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h4>Histogram on a categorical variable</h4>
<p>Histogram on a categorical variable would result in a frequency chart showing bars for each category. By adjusting <code>width</code>, you can adjust the thickness of the bars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Histogram on a Categorical variable</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(manufacturer))
g +<span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>class), <span class="dt">width =</span> <span class="fl">0.5</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">65</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Histogram on Categorical Variable&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Manufacturer across Vehicle Classes&quot;</span>) </code></pre></div>
<p><img src="screenshots/ggplot_masterlist_22.png" alt="Ggplot Histogram on Categorical Variable" /></p>
<p>So according to this dataset, only chevrolet manufactures 2seaters. Jeep, landrover, lincoln and mercury makes only SUVs. Also, Toyota seems to have the largest mix, with 4 classes of cars. Can you think of a couple of such observations?</p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Density Plot"></a>Density plot</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Plot</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(cty))
g +<span class="st"> </span><span class="kw">geom_density</span>(<span class="kw">aes</span>(<span class="dt">fill=</span><span class="kw">factor</span>(cyl))) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Density plot&quot;</span>, 
                                               <span class="dt">subtitle=</span><span class="st">&quot;City Mileage Grouped by Number of cylinders&quot;</span>,
                                               <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,
                                               <span class="dt">x=</span><span class="st">&quot;City Mileage&quot;</span>,
                                               <span class="dt">fill=</span><span class="st">&quot;# Cylinders&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_23.png" alt="Ggplot Density Plot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Box Plot"></a>Box Plot</h3>
<p>Boxplot shows the distributions within multiple groups, additionally showing the median, range and outliers if any. The dark line inside the box represents the median. The top of box is 75%ile and bottom of box is 25%ile. The end points of the lines (aka whiskers) is at a distance of 1.5*IQR, where IQR or Inter Quartile Range is the distance between 25th and 75th percentiles. The points outside the whiskers are marked as dots and are normally considered as extreme points.</p>
<p>Setting <code>varwidth=T</code> adjusts the width of the boxes to be proportional to the number of observation it contains.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Plot</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(class, cty))
g +<span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">varwidth=</span>T, <span class="dt">fill=</span><span class="st">&quot;plum&quot;</span>) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Box plot&quot;</span>, 
                                                 <span class="dt">subtitle=</span><span class="st">&quot;City Mileage grouped by Class of vehicle&quot;</span>,
                                                 <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,
                                                 <span class="dt">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,
                                                 <span class="dt">y=</span><span class="st">&quot;City Mileage&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_24.png" alt="Ggplot BoxPlot" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggthemes)
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(class, cty))
g +<span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill=</span><span class="kw">factor</span>(cyl))) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">65</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Box plot&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;City Mileage grouped by Class of vehicle&quot;</span>,
       <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,
       <span class="dt">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,
       <span class="dt">y=</span><span class="st">&quot;City Mileage&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_25.png" alt="Ggplot Grouped BoxPlot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Dot + Box Plot"></a>Dot + Box Plot</h3>
<p>The dotplot can provide more clear information in the form of summary statistics by each group. The dots are stacked such that each dot represents one observation. So, in below chart, the number of dots for a given manufacturer will match the number of rows of that manufacturer in source data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

<span class="co"># plot</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(manufacturer, cty))
g +<span class="st"> </span><span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_dotplot</span>(<span class="dt">binaxis=</span><span class="st">&#39;y&#39;</span>, <span class="dt">stackdir=</span><span class="st">&#39;center&#39;</span>, <span class="dt">dotsize =</span> .<span class="dv">5</span>, <span class="dt">fill=</span><span class="st">&quot;red&quot;</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">65</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Box plot + Dot plot&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;City Mileage vs Class: Each dot represents 1 row in source data&quot;</span>,
       <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,
       <span class="dt">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,
       <span class="dt">y=</span><span class="st">&quot;City Mileage&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_26.png" alt="Ggplot Box and DotPlot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Tufte Boxplot"></a>Tufte Boxplot</h3>
<p>Tufte boxplot, provided by <code>ggthemes</code> package is inspired by the works of Edward Tufte. Tufte’s Boxplot is just a box plot made minimal and visually appealing.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggthemes)
<span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_tufte</span>())  <span class="co"># from ggthemes</span>

<span class="co"># plot</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(manufacturer, cty))
g +<span class="st"> </span><span class="kw">geom_tufteboxplot</span>() +<span class="st"> </span>
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">65</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>)) +<span class="st"> </span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Tufte Styled Boxplot&quot;</span>, 
           <span class="dt">subtitle=</span><span class="st">&quot;City Mileage grouped by Class of vehicle&quot;</span>,
           <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,
           <span class="dt">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,
           <span class="dt">y=</span><span class="st">&quot;City Mileage&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_27.png" alt="Ggplot Tufte Boxplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Violin Plot"></a>Violin Plot</h3>
<p>A violin plot is similar to boxplot but shows the density within groups. Not much info provided as in boxplots. It can be drawn using <code>geom_violin()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

<span class="co"># plot</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(class, cty))
g +<span class="st"> </span><span class="kw">geom_violin</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Violin plot&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;City Mileage vs Class of vehicle&quot;</span>,
       <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>,
       <span class="dt">x=</span><span class="st">&quot;Class of Vehicle&quot;</span>,
       <span class="dt">y=</span><span class="st">&quot;City Mileage&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_28.png" alt="Ggplot Violin Plot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Population Pyramid"></a>Population Pyramid</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggthemes)
<span class="kw">options</span>(<span class="dt">scipen =</span> <span class="dv">999</span>)  <span class="co"># turns of scientific notations like 1e+40</span>

<span class="co"># Read data</span>
email_campaign_funnel &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/selva86/datasets/master/email_campaign_funnel.csv&quot;</span>)

<span class="co"># X Axis Breaks and Labels </span>
brks &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="dv">15000000</span>, <span class="dv">15000000</span>, <span class="dv">5000000</span>)
lbls =<span class="st"> </span><span class="kw">paste0</span>(<span class="kw">as.character</span>(<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">15</span>, <span class="dv">0</span>, -<span class="dv">5</span>), <span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">5</span>))), <span class="st">&quot;m&quot;</span>)

<span class="co"># Plot</span>
<span class="kw">ggplot</span>(email_campaign_funnel, <span class="kw">aes</span>(<span class="dt">x =</span> Stage, <span class="dt">y =</span> Users, <span class="dt">fill =</span> Gender)) +<span class="st">   </span><span class="co"># Fill column</span>
<span class="st">                              </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> .<span class="dv">6</span>) +<span class="st">   </span><span class="co"># draw the bars</span>
<span class="st">                              </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> brks,   <span class="co"># Breaks</span>
                                                 <span class="dt">labels =</span> lbls) +<span class="st"> </span><span class="co"># Labels</span>
<span class="st">                              </span><span class="kw">coord_flip</span>() +<span class="st">  </span><span class="co"># Flip axes</span>
<span class="st">                              </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Email Campaign Funnel&quot;</span>) +
<span class="st">                              </span><span class="kw">theme_tufte</span>() +<span class="st">  </span><span class="co"># Tufte theme from ggfortify</span>
<span class="st">                              </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> .<span class="dv">5</span>), 
                                    <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>()) +<span class="st">   </span><span class="co"># Centre plot title</span>
<span class="st">                              </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>)  <span class="co"># Color palette</span></code></pre></div>
<p><img src="screenshots/ggplot_masterlist_29.png" alt="Population Pyramid With Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h2>5. Composition</h2>
<h3><a name="Waffle Chart"></a>Waffle Chart</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">var &lt;-<span class="st"> </span>mpg$class  <span class="co"># the categorical data </span>

## Prep data (nothing to change here)
nrows &lt;-<span class="st"> </span><span class="dv">10</span>
df &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">y =</span> <span class="dv">1</span>:nrows, <span class="dt">x =</span> <span class="dv">1</span>:nrows)
categ_table &lt;-<span class="st"> </span><span class="kw">round</span>(<span class="kw">table</span>(var) *<span class="st"> </span>((nrows*nrows)/(<span class="kw">length</span>(var))))
categ_table
<span class="co">#&gt;   2seater    compact    midsize    minivan     pickup subcompact        suv </span>
<span class="co">#&gt;         2         20         18          5         14         15         26 </span>

df$category &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="kw">names</span>(categ_table), categ_table))  
<span class="co"># NOTE: if sum(categ_table) is not 100 (i.e. nrows^2), it will need adjustment to make the sum to 100.</span>

## Plot
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> category)) +<span class="st"> </span>
<span class="st">        </span><span class="kw">geom_tile</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>) +
<span class="st">        </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +
<span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">trans =</span> <span class="st">&#39;reverse&#39;</span>) +
<span class="st">        </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Set3&quot;</span>) +
<span class="st">        </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Waffle Chart&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;&#39;Class&#39; of vehicles&quot;</span>,
             <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>) +<span class="st"> </span>
<span class="st">        </span><span class="kw">theme</span>(<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">size =</span> <span class="dv">2</span>),
              <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="kw">rel</span>(<span class="fl">1.2</span>)),
              <span class="dt">axis.text =</span> <span class="kw">element_blank</span>(),
              <span class="dt">axis.title =</span> <span class="kw">element_blank</span>(),
              <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),
              <span class="dt">legend.title =</span> <span class="kw">element_blank</span>(),
              <span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_30.png" alt="Waffle Chart With Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Pie Chart"></a>Pie Chart</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Source: Frequency table</span>
df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(mpg$class))
<span class="kw">colnames</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;class&quot;</span>, <span class="st">&quot;freq&quot;</span>)
pie &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y=</span>freq, <span class="dt">fill =</span> <span class="kw">factor</span>(class))) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_blank</span>(), <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill=</span><span class="st">&quot;class&quot;</span>, <span class="dt">x=</span><span class="ot">NULL</span>, <span class="dt">y=</span><span class="ot">NULL</span>, <span class="dt">title=</span><span class="st">&quot;Pie Chart of class&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>)

pie +<span class="st"> </span><span class="kw">coord_polar</span>(<span class="dt">theta =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">start=</span><span class="dv">0</span>)

<span class="co"># Source: Categorical variable.</span>
<span class="co"># mpg$class</span>
pie &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">fill =</span> <span class="kw">factor</span>(class))) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="dv">1</span>) +
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.line =</span> <span class="kw">element_blank</span>(), <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill=</span><span class="st">&quot;class&quot;</span>, <span class="dt">x=</span><span class="ot">NULL</span>, <span class="dt">y=</span><span class="ot">NULL</span>, <span class="dt">title=</span><span class="st">&quot;Pie Chart of class&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: mpg&quot;</span>)
  
pie +<span class="st"> </span><span class="kw">coord_polar</span>(<span class="dt">theta =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">start=</span><span class="dv">0</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_31.png" alt="Pie Chart With Ggplot" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># http://www.r-graph-gallery.com/128-ring-or-donut-plot/</span></code></pre></div>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Treemap"></a>Treemap</h3>
<p>Treemap: treemapping is a method for displaying hierarchical data by using nested rectangles.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2) 
<span class="kw">library</span>(treemapify)
proglangs &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/selva86/datasets/master/proglanguages.csv&quot;</span>)

<span class="co"># plot</span>
treeMapCoordinates &lt;-<span class="st"> </span><span class="kw">treemapify</span>(proglangs,
                                 <span class="dt">area =</span> <span class="st">&quot;value&quot;</span>,
                                 <span class="dt">fill =</span> <span class="st">&quot;parent&quot;</span>,
                                 <span class="dt">label =</span> <span class="st">&quot;id&quot;</span>,
                                 <span class="dt">group =</span> <span class="st">&quot;parent&quot;</span>)

treeMapPlot &lt;-<span class="st"> </span><span class="kw">ggplotify</span>(treeMapCoordinates) +<span class="st"> </span>
<span class="st">                  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +
<span class="st">                  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +
<span class="st">                  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;Dark2&quot;</span>)

<span class="kw">print</span>(treeMapPlot)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_32.png" alt="Treemap With Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Bar Chart"></a>Bar Chart</h3>
<p>A bar chart can be drawn from a categorical column variable or from a separate frequency table. By adjusting <code>width</code>, you can adjust the thickness of the bars. If your data source is a frequency table, that is, if you don’t want ggplot to compute the counts, you need to set the <code>stat=identity</code> inside the <code>geom_bar()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># prep frequency table</span>
freqtable &lt;-<span class="st"> </span><span class="kw">table</span>(mpg$manufacturer)
df &lt;-<span class="st"> </span><span class="kw">as.data.frame.table</span>(freqtable)
<span class="kw">head</span>(df)
<span class="co">#&gt;          Var1 Freq</span>
<span class="co">#&gt; 1        audi   18</span>
<span class="co">#&gt; 2   chevrolet   19</span>
<span class="co">#&gt; 3       dodge   37</span>
<span class="co">#&gt; 4        ford   25</span>
<span class="co">#&gt; 5       honda    9</span>
<span class="co">#&gt; 6     hyundai   14</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Plot</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df, <span class="kw">aes</span>(Var1, Freq))
g +<span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">fill=</span><span class="st">&quot;tomato2&quot;</span>) +<span class="st"> </span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Bar Chart&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Manufacturer of vehicles&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: Frequency of Manufacturers from &#39;mpg&#39; dataset&quot;</span>) +
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">65</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>))</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_33.png" alt="Bar Chart With Ggplot" /></p>
<p>It can be computed directly from a column variable as well. In this case, only X is provided and <code>stat=identity</code> is <em>not</em> set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># From on a categorical column variable</span>
g &lt;-<span class="st"> </span><span class="kw">ggplot</span>(mpg, <span class="kw">aes</span>(manufacturer))
g +<span class="st"> </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>class), <span class="dt">width =</span> <span class="fl">0.5</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle=</span><span class="dv">65</span>, <span class="dt">vjust=</span><span class="fl">0.6</span>)) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Categorywise Bar Chart&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Manufacturer of vehicles&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: Manufacturers from &#39;mpg&#39; dataset&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_34.png" alt="Bar Chart With Multiple Categories in Ggplot" /></p>
<p>So according to this dataset, only chevrolet manufactures 2seaters. Jeep, landrover, lincoln and mercury makes only SUVs. Also, Toyota seems to have the largest mix, with 4 classes of cars. Can you think of a couple of such observations?</p>
<p><a href="#top">[Back to Top]</a></p>
<h2>6. Change</h2>
<h3><a name="Time Series Plots"></a>Time Series Plots</h3>
<h4>From a Time Series Object (<code>ts</code>)</h4>
<p>The <code>ggfortify</code> package allows autoplot to automatically plot directly from a time series object (<code>ts</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## From Timeseries object (ts)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggfortify)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Plot </span>
<span class="kw">autoplot</span>(AirPassengers) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;AirPassengers&quot;</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>))</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_35.png" alt="Time series in ggplot with ts object" /></p>
<h4>From a Data Frame</h4>
<h5>Default X Axis Labels</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Allow Default X Axis Labels</span>
<span class="kw">ggplot</span>(economics, <span class="kw">aes</span>(<span class="dt">x=</span>date)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>returns_perc)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Time Series Chart&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;Returns Percentage from &#39;Economics&#39; Dataset&quot;</span>, 
       <span class="dt">caption=</span><span class="st">&quot;Source: Economics&quot;</span>, 
       <span class="dt">y=</span><span class="st">&quot;Returns %&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_36.png" alt="Time series in ggplot from Dataframe" /></p>
<h4>How to Format X Axis Labels for a <em>Monthly</em> Time Series</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lubridate)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

economics_m &lt;-<span class="st"> </span>economics[<span class="dv">1</span>:<span class="dv">24</span>, ]

<span class="co"># labels and breaks for X axis text</span>
lbls &lt;-<span class="st"> </span><span class="kw">paste0</span>(month.abb[<span class="kw">month</span>(economics_m$date)], <span class="st">&quot; &quot;</span>, lubridate::<span class="kw">year</span>(economics_m$date))
brks &lt;-<span class="st"> </span>economics_m$date

<span class="co"># plot</span>
<span class="kw">ggplot</span>(economics_m, <span class="kw">aes</span>(<span class="dt">x=</span>date)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>returns_perc)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Monthly Time Series&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Returns Percentage from Economics Dataset&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: Economics&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Returns %&quot;</span>) +<span class="st">  </span><span class="co"># title and caption</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> lbls, <span class="dt">breaks =</span> brks) +<span class="st">  </span><span class="co"># change to monthly ticks and labels</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>),  <span class="co"># rotate x axis text</span>
        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())  <span class="co"># turn off minor grid</span></code></pre></div>
<p><img src="screenshots/ggplot_masterlist_37.png" alt="Monthly Time series in ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h4>How to Format X Axis Labels for a <em>Yearly</em> Time Series</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lubridate)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

economics_y &lt;-<span class="st"> </span>economics[<span class="dv">1</span>:<span class="dv">90</span>, ]

<span class="co"># labels and breaks for X axis text</span>
brks &lt;-<span class="st"> </span>economics_y$date[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(economics_y$date), <span class="dv">12</span>)]
lbls &lt;-<span class="st"> </span>lubridate::<span class="kw">year</span>(brks)

<span class="co"># plot</span>
<span class="kw">ggplot</span>(economics_y, <span class="kw">aes</span>(<span class="dt">x=</span>date)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>returns_perc)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Yearly Time Series&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Returns Percentage from Economics Dataset&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;Source: Economics&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Returns %&quot;</span>) +<span class="st">  </span><span class="co"># title and caption</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> lbls, <span class="dt">breaks =</span> brks) +<span class="st">  </span><span class="co"># change to monthly ticks and labels</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>),  <span class="co"># rotate x axis text</span>
        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())  <span class="co"># turn off minor grid</span></code></pre></div>
<p><img src="screenshots/ggplot_masterlist_38.png" alt="Yearly Time series in ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h4>Long Data Format: Multiple Time Series in Same Dataframe</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lubridate)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

df &lt;-<span class="st"> </span>economics_long[economics_long$variable %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;psavert&quot;</span>, <span class="st">&quot;uempmed&quot;</span>), ]
df &lt;-<span class="st"> </span>df[lubridate::<span class="kw">year</span>(df$date) %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">1967</span>:<span class="dv">1981</span>), ]

<span class="co"># labels and breaks for X axis text</span>
brks &lt;-<span class="st"> </span>df$date[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(df$date), <span class="dv">12</span>)]
lbls &lt;-<span class="st"> </span>lubridate::<span class="kw">year</span>(brks)

<span class="co"># plot</span>
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>date)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>value, <span class="dt">col=</span>variable)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Time Series of Returns Percentage&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;Drawn from Long Data format&quot;</span>, 
       <span class="dt">caption=</span><span class="st">&quot;Source: Economics&quot;</span>, 
       <span class="dt">y=</span><span class="st">&quot;Returns %&quot;</span>, 
       <span class="dt">color=</span><span class="ot">NULL</span>) +<span class="st">  </span><span class="co"># title and caption</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> lbls, <span class="dt">breaks =</span> brks) +<span class="st">  </span><span class="co"># change to monthly ticks and labels</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;psavert&quot;</span>, <span class="st">&quot;uempmed&quot;</span>), 
                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;psavert&quot;</span>=<span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;uempmed&quot;</span>=<span class="st">&quot;#f8766d&quot;</span>)) +<span class="st">  </span><span class="co"># line color</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">vjust=</span><span class="fl">0.5</span>, <span class="dt">size =</span> <span class="dv">8</span>),  <span class="co"># rotate x axis text</span>
        <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())  <span class="co"># turn off minor grid</span></code></pre></div>
<p><img src="screenshots/ggplot_masterlist_39.png" alt="Yearly Time series in ggplot from Long Data format" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h4>Wide Data Format: Multiple Time Series in Same Dataframe</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lubridate)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

df &lt;-<span class="st"> </span>economics[, <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;psavert&quot;</span>, <span class="st">&quot;uempmed&quot;</span>)]
df &lt;-<span class="st"> </span>df[lubridate::<span class="kw">year</span>(df$date) %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">1967</span>:<span class="dv">1981</span>), ]

<span class="co"># labels and breaks for X axis text</span>
brks &lt;-<span class="st"> </span>df$date[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(df$date), <span class="dv">12</span>)]
lbls &lt;-<span class="st"> </span>lubridate::<span class="kw">year</span>(brks)

<span class="co"># plot</span>
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>date)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>psavert, <span class="dt">col=</span><span class="st">&quot;psavert&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y=</span>uempmed, <span class="dt">col=</span><span class="st">&quot;uempmed&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Time Series of Returns Percentage&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;Drawn From Wide Data format&quot;</span>, 
       <span class="dt">caption=</span><span class="st">&quot;Source: Economics&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Returns %&quot;</span>) +<span class="st">  </span><span class="co"># title and caption</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> lbls, <span class="dt">breaks =</span> brks) +<span class="st">  </span><span class="co"># change to monthly ticks and labels</span>
<span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">name=</span><span class="st">&quot;&quot;</span>, 
                     <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;psavert&quot;</span>=<span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;uempmed&quot;</span>=<span class="st">&quot;#f8766d&quot;</span>)) +<span class="st">  </span><span class="co"># line color</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())  <span class="co"># turn off minor grid</span></code></pre></div>
<p><img src="screenshots/ggplot_masterlist_40.png" alt="Time series in ggplot from Wide Data Format" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Stacked Area Chart"></a>Stacked Area Chart</h3>
<p>Show how something changed over time along with the contributions from individual components. The caveat is: it is nice to look at but can easily become complicated and uninterprettable if there are too many components.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lubridate)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

df &lt;-<span class="st"> </span>economics[, <span class="kw">c</span>(<span class="st">&quot;date&quot;</span>, <span class="st">&quot;psavert&quot;</span>, <span class="st">&quot;uempmed&quot;</span>)]
df &lt;-<span class="st"> </span>df[lubridate::<span class="kw">year</span>(df$date) %in%<span class="st"> </span><span class="kw">c</span>(<span class="dv">1967</span>:<span class="dv">1981</span>), ]

<span class="co"># labels and breaks for X axis text</span>
brks &lt;-<span class="st"> </span>df$date[<span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">length</span>(df$date), <span class="dv">12</span>)]
lbls &lt;-<span class="st"> </span>lubridate::<span class="kw">year</span>(brks)

<span class="co"># plot</span>
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>date)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">y=</span>psavert, <span class="dt">fill=</span><span class="st">&quot;psavert&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_area</span>(<span class="kw">aes</span>(<span class="dt">y=</span>uempmed, <span class="dt">fill=</span><span class="st">&quot;uempmed&quot;</span>)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Area Chart of Returns Percentage&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;From Wide Data format&quot;</span>, 
       <span class="dt">caption=</span><span class="st">&quot;Source: Economics&quot;</span>, 
       <span class="dt">y=</span><span class="st">&quot;Returns %&quot;</span>) +<span class="st">  </span><span class="co"># title and caption</span>
<span class="st">  </span><span class="kw">scale_x_date</span>(<span class="dt">labels =</span> lbls, <span class="dt">breaks =</span> brks) +<span class="st">  </span><span class="co"># change to monthly ticks and labels</span>
<span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">name=</span><span class="st">&quot;&quot;</span>, <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;psavert&quot;</span>=<span class="st">&quot;#00ba38&quot;</span>, <span class="st">&quot;uempmed&quot;</span>=<span class="st">&quot;#f8766d&quot;</span>)) +<span class="st">  </span><span class="co"># line color</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())  <span class="co"># turn off minor grid</span></code></pre></div>
<p><img src="screenshots/ggplot_masterlist_41.png" alt="Stacked Area Chart in Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Calendar Heatmap"></a>Calendar Heatmap</h3>
<p>Calendar Heatmap: Shows variation visually over time rather than the actual value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># http://margintale.blogspot.in/2012/04/ggplot2-time-series-heatmaps.html</span>
<span class="kw">require</span>(ggplot2)
<span class="kw">require</span>(plyr)
<span class="kw">require</span>(scales)
df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/selva86/datasets/master/yahoo.csv&quot;</span>)
df$date &lt;-<span class="st"> </span><span class="kw">as.Date</span>(df$date)  <span class="co"># format date</span>
df &lt;-<span class="st"> </span>df[df$year &gt;=<span class="st"> </span><span class="dv">2012</span>, ]  <span class="co"># filter reqd years</span>

<span class="co"># Create Month Week</span>
df$yearmonth &lt;-<span class="st"> </span><span class="kw">as.yearmon</span>(df$date)
df$yearmonthf &lt;-<span class="st"> </span><span class="kw">factor</span>(df$yearmonth)
df &lt;-<span class="st"> </span><span class="kw">ddply</span>(df,.(yearmonthf), transform, <span class="dt">monthweek=</span><span class="dv">1</span>+week-<span class="kw">min</span>(week))

<span class="co"># Plot</span>
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(monthweek, weekdayf, <span class="dt">fill =</span> VIX.Close)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">facet_grid</span>(year~monthf) +<span class="st"> </span>
<span class="st">  </span><span class="kw">scale_fill_gradient</span>(<span class="dt">low=</span><span class="st">&quot;red&quot;</span>, <span class="dt">high=</span><span class="st">&quot;green&quot;</span>) +
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Time-Series Calendar Heatmap&quot;</span>, <span class="dt">subtitle=</span><span class="st">&quot;Yahoo Cloing Price&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;Close&quot;</span>) +<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Week of Month&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_42.png" alt="Calendar Heatmap in Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Slope Chart"></a>Slope Chart</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())
source_df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/jkeirstead/r-slopegraph/master/cancer_survival_rates.csv&quot;</span>)

<span class="co"># Define functions. Source: https://github.com/jkeirstead/r-slopegraph</span>
tufte_sort &lt;-<span class="st"> </span>function(df, <span class="dt">x=</span><span class="st">&quot;year&quot;</span>, <span class="dt">y=</span><span class="st">&quot;value&quot;</span>, <span class="dt">group=</span><span class="st">&quot;group&quot;</span>, <span class="dt">method=</span><span class="st">&quot;tufte&quot;</span>, <span class="dt">min.space=</span><span class="fl">0.05</span>) {
    ## First rename the columns for consistency
    ids &lt;-<span class="st"> </span><span class="kw">match</span>(<span class="kw">c</span>(x, y, group), <span class="kw">names</span>(df))
    df &lt;-<span class="st"> </span>df[,ids]
    <span class="kw">names</span>(df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>, <span class="st">&quot;group&quot;</span>)

    ## Expand grid to ensure every combination has a defined value
    tmp &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x=</span><span class="kw">unique</span>(df$x), <span class="dt">group=</span><span class="kw">unique</span>(df$group))
    tmp &lt;-<span class="st"> </span><span class="kw">merge</span>(df, tmp, <span class="dt">all.y=</span><span class="ot">TRUE</span>)
    df &lt;-<span class="st"> </span><span class="kw">mutate</span>(tmp, <span class="dt">y=</span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(y), <span class="dv">0</span>, y))
  
    ## Cast into a matrix shape and arrange by first column
    <span class="kw">require</span>(reshape2)
    tmp &lt;-<span class="st"> </span><span class="kw">dcast</span>(df, group ~<span class="st"> </span>x, <span class="dt">value.var=</span><span class="st">&quot;y&quot;</span>)
    ord &lt;-<span class="st"> </span><span class="kw">order</span>(tmp[,<span class="dv">2</span>])
    tmp &lt;-<span class="st"> </span>tmp[ord,]
    
    min.space &lt;-<span class="st"> </span>min.space*<span class="kw">diff</span>(<span class="kw">range</span>(tmp[,-<span class="dv">1</span>]))
    yshift &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">nrow</span>(tmp))
    ## Start at &quot;bottom&quot; row
    ## Repeat for rest of the rows until you hit the top
    for (i in <span class="dv">2</span>:<span class="kw">nrow</span>(tmp)) {
        ## Shift subsequent row up by equal space so gap between
        ## two entries is &gt;= minimum
        mat &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(tmp[(i<span class="dv">-1</span>):i, -<span class="dv">1</span>])
        d.min &lt;-<span class="st"> </span><span class="kw">min</span>(<span class="kw">diff</span>(mat))
        yshift[i] &lt;-<span class="st"> </span><span class="kw">ifelse</span>(d.min &lt;<span class="st"> </span>min.space, min.space -<span class="st"> </span>d.min, <span class="dv">0</span>)
    }

    
    tmp &lt;-<span class="st"> </span><span class="kw">cbind</span>(tmp, <span class="dt">yshift=</span><span class="kw">cumsum</span>(yshift))

    scale &lt;-<span class="st"> </span><span class="dv">1</span>
    tmp &lt;-<span class="st"> </span><span class="kw">melt</span>(tmp, <span class="dt">id=</span><span class="kw">c</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;yshift&quot;</span>), <span class="dt">variable.name=</span><span class="st">&quot;x&quot;</span>, <span class="dt">value.name=</span><span class="st">&quot;y&quot;</span>)
    ## Store these gaps in a separate variable so that they can be scaled ypos = a*yshift + y

    tmp &lt;-<span class="st"> </span><span class="kw">transform</span>(tmp, <span class="dt">ypos=</span>y +<span class="st"> </span>scale*yshift)
    <span class="kw">return</span>(tmp)
   
}

plot_slopegraph &lt;-<span class="st"> </span>function(df) {
    ylabs &lt;-<span class="st"> </span><span class="kw">subset</span>(df, x==<span class="kw">head</span>(x,<span class="dv">1</span>))$group
    yvals &lt;-<span class="st"> </span><span class="kw">subset</span>(df, x==<span class="kw">head</span>(x,<span class="dv">1</span>))$ypos
    fontSize &lt;-<span class="st"> </span><span class="dv">3</span>
    gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(df,<span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>ypos)) +
<span class="st">        </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group=</span>group),<span class="dt">colour=</span><span class="st">&quot;grey80&quot;</span>) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">colour=</span><span class="st">&quot;white&quot;</span>,<span class="dt">size=</span><span class="dv">8</span>) +
<span class="st">        </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>y), <span class="dt">size=</span>fontSize, <span class="dt">family=</span><span class="st">&quot;American Typewriter&quot;</span>) +
<span class="st">        </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;&quot;</span>, <span class="dt">breaks=</span>yvals, <span class="dt">labels=</span>ylabs)
    <span class="kw">return</span>(gg)
}    

## Prepare data    
df &lt;-<span class="st"> </span><span class="kw">tufte_sort</span>(source_df, <span class="dt">x=</span><span class="st">&quot;year&quot;</span>, <span class="dt">y=</span><span class="st">&quot;value&quot;</span>, <span class="dt">group=</span><span class="st">&quot;group&quot;</span>, <span class="dt">method=</span><span class="st">&quot;tufte&quot;</span>, <span class="dt">min.space=</span><span class="fl">0.05</span>)
df &lt;-<span class="st"> </span><span class="kw">transform</span>(df, <span class="dt">x=</span><span class="kw">factor</span>(x, <span class="dt">levels=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>,<span class="dv">20</span>), <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;5 years&quot;</span>,<span class="st">&quot;10 years&quot;</span>,<span class="st">&quot;15 years&quot;</span>,<span class="st">&quot;20 years&quot;</span>)), 
                <span class="dt">y=</span><span class="kw">round</span>(y))

## Plot
<span class="kw">plot_slopegraph</span>(df) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Estimates of % survival rates&quot;</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title=</span><span class="kw">element_blank</span>(), 
                                                                          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>(),
                                                                          <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust=</span><span class="fl">0.5</span>,
                                                                                                    <span class="dt">family =</span> <span class="st">&quot;American Typewriter&quot;</span>,
                                                                                                    <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>),
                                                                          <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">family =</span> <span class="st">&quot;American Typewriter&quot;</span>,
                                                                                                   <span class="dt">face=</span><span class="st">&quot;bold&quot;</span>))</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_43.png" alt="Slopechart in Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Seasonal Plot"></a>Seasonal Plot</h3>
<p>If you are working with a time series object of class <code>ts</code> or <code>xts</code>, you can view the seasonal fluctuations through a seasonal plot drawn using <code>forecast::ggseasonplot</code>. Below is an example using the native <code>nottem</code> time series.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(forecast)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Subset data</span>
nottem_small &lt;-<span class="st"> </span><span class="kw">window</span>(nottem, <span class="dt">start=</span><span class="kw">c</span>(<span class="dv">1920</span>, <span class="dv">1</span>), <span class="dt">end=</span><span class="kw">c</span>(<span class="dv">1925</span>, <span class="dv">12</span>))  <span class="co"># subset a smaller timewindow</span>

<span class="co"># Plot</span>
<span class="kw">ggseasonplot</span>(AirPassengers) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Seasonal plot: International Airline Passengers&quot;</span>)
<span class="kw">ggseasonplot</span>(nottem_small) +<span class="st"> </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Seasonal plot: Air temperatures at Nottingham Castle&quot;</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_45.png" alt="Seasonal Plot in Ggplot" /> <br> <img src="screenshots/ggplot_masterlist_46.png" alt="Seasonal Plot in Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h2>7. Groups</h2>
<h3><a name="Hierarchical Dendrogram"></a>Hierarchical Dendrogram</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;ggdendro&quot;)</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggdendro)
<span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())

hc &lt;-<span class="st"> </span><span class="kw">hclust</span>(<span class="kw">dist</span>(USArrests), <span class="st">&quot;ave&quot;</span>)  <span class="co"># hierarchical clustering</span>

<span class="co"># plot</span>
<span class="kw">ggdendrogram</span>(hc, <span class="dt">rotate =</span> <span class="ot">TRUE</span>, <span class="dt">size =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_48.png" alt="Hierarchical Dendrogram in Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3><a name="Clusters"></a>Clusters</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggalt)
<span class="kw">library</span>(ggfortify)
<span class="kw">theme_set</span>(<span class="kw">theme_classic</span>())

<span class="co"># Compute data with principal components ------------------</span>
df &lt;-<span class="st"> </span>iris[<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)]
pca_mod &lt;-<span class="st"> </span><span class="kw">prcomp</span>(df)  <span class="co"># compute principal components</span>

<span class="co"># Data frame of principal components ----------------------</span>
df_pc &lt;-<span class="st"> </span><span class="kw">data.frame</span>(pca_mod$x, <span class="dt">Species=</span>iris$Species)  <span class="co"># dataframe of principal components</span>
df_pc_vir &lt;-<span class="st"> </span>df_pc[df_pc$Species ==<span class="st"> &quot;virginica&quot;</span>, ]  <span class="co"># df for &#39;virginica&#39;</span>
df_pc_set &lt;-<span class="st"> </span>df_pc[df_pc$Species ==<span class="st"> &quot;setosa&quot;</span>, ]  <span class="co"># df for &#39;setosa&#39;</span>
df_pc_ver &lt;-<span class="st"> </span>df_pc[df_pc$Species ==<span class="st"> &quot;versicolor&quot;</span>, ]  <span class="co"># df for &#39;versicolor&#39;</span>
 
<span class="co"># Plot ----------------------------------------------------</span>
<span class="kw">ggplot</span>(df_pc, <span class="kw">aes</span>(PC1, PC2, <span class="dt">col=</span>Species)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">shape=</span>Species), <span class="dt">size=</span><span class="dv">2</span>) +<span class="st">   </span><span class="co"># draw points</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Iris Clustering&quot;</span>, 
       <span class="dt">subtitle=</span><span class="st">&quot;With principal components PC1 and PC2 as X and Y axis&quot;</span>,
       <span class="dt">caption=</span><span class="st">&quot;Source: Iris&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">xlim =</span> <span class="fl">1.2</span> *<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(df_pc$PC1), <span class="kw">max</span>(df_pc$PC1)), 
                  <span class="dt">ylim =</span> <span class="fl">1.2</span> *<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(df_pc$PC2), <span class="kw">max</span>(df_pc$PC2))) +<span class="st">   </span><span class="co"># change axis limits</span>
<span class="st">  </span><span class="kw">geom_encircle</span>(<span class="dt">data =</span> df_pc_vir, <span class="kw">aes</span>(<span class="dt">x=</span>PC1, <span class="dt">y=</span>PC2)) +<span class="st">   </span><span class="co"># draw circles</span>
<span class="st">  </span><span class="kw">geom_encircle</span>(<span class="dt">data =</span> df_pc_set, <span class="kw">aes</span>(<span class="dt">x=</span>PC1, <span class="dt">y=</span>PC2)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_encircle</span>(<span class="dt">data =</span> df_pc_ver, <span class="kw">aes</span>(<span class="dt">x=</span>PC1, <span class="dt">y=</span>PC2))</code></pre></div>
<p><img src="screenshots/ggplot_masterlist_49.png" alt="Clustering in Ggplot" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h2>8. Spatial</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Better install the dev versions ----------</span>
<span class="co"># devtools::install_github(&quot;dkahle/ggmap&quot;)</span>
<span class="co"># devtools::install_github(&quot;hrbrmstr/ggalt&quot;)</span>

<span class="co"># load packages</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(ggmap)
<span class="kw">library</span>(ggalt)

<span class="co"># Get Chennai&#39;s Coordinates --------------------------------</span>
chennai &lt;-<span class="st">  </span><span class="kw">geocode</span>(<span class="st">&quot;Chennai&quot;</span>)  <span class="co"># get longitude and latitude</span>

<span class="co"># Get the Map ----------------------------------------------</span>
<span class="co"># Google Satellite Map</span>
chennai_ggl_sat_map &lt;-<span class="st"> </span><span class="kw">qmap</span>(<span class="st">&quot;chennai&quot;</span>, <span class="dt">zoom=</span><span class="dv">12</span>, <span class="dt">source =</span> <span class="st">&quot;google&quot;</span>, <span class="dt">maptype=</span><span class="st">&quot;satellite&quot;</span>)  

<span class="co"># Google Road Map</span>
chennai_ggl_road_map &lt;-<span class="st"> </span><span class="kw">qmap</span>(<span class="st">&quot;chennai&quot;</span>, <span class="dt">zoom=</span><span class="dv">12</span>, <span class="dt">source =</span> <span class="st">&quot;google&quot;</span>, <span class="dt">maptype=</span><span class="st">&quot;roadmap&quot;</span>)  

<span class="co"># Google Hybrid Map</span>
chennai_ggl_hybrid_map &lt;-<span class="st"> </span><span class="kw">qmap</span>(<span class="st">&quot;chennai&quot;</span>, <span class="dt">zoom=</span><span class="dv">12</span>, <span class="dt">source =</span> <span class="st">&quot;google&quot;</span>, <span class="dt">maptype=</span><span class="st">&quot;hybrid&quot;</span>)  

<span class="co"># Open Street Map</span>
chennai_osm_map &lt;-<span class="st"> </span><span class="kw">qmap</span>(<span class="st">&quot;chennai&quot;</span>, <span class="dt">zoom=</span><span class="dv">12</span>, <span class="dt">source =</span> <span class="st">&quot;osm&quot;</span>)   

<span class="co"># Get Coordinates for Chennai&#39;s Places ---------------------</span>
chennai_places &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Kolathur&quot;</span>,
                    <span class="st">&quot;Washermanpet&quot;</span>,
                    <span class="st">&quot;Royapettah&quot;</span>,
                    <span class="st">&quot;Adyar&quot;</span>,
                    <span class="st">&quot;Guindy&quot;</span>)

places_loc &lt;-<span class="st"> </span><span class="kw">geocode</span>(chennai_places)  <span class="co"># get longitudes and latitudes</span>


<span class="co"># Plot Open Street Map -------------------------------------</span>
chennai_osm_map +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>lon, <span class="dt">y=</span>lat),
                             <span class="dt">data =</span> places_loc, 
                             <span class="dt">alpha =</span> <span class="fl">0.7</span>, 
                             <span class="dt">size =</span> <span class="dv">7</span>, 
                             <span class="dt">color =</span> <span class="st">&quot;tomato&quot;</span>) +<span class="st"> </span>
<span class="st">                  </span><span class="kw">geom_encircle</span>(<span class="kw">aes</span>(<span class="dt">x=</span>lon, <span class="dt">y=</span>lat),
                                <span class="dt">data =</span> places_loc, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)

<span class="co"># Plot Google Road Map -------------------------------------</span>
chennai_ggl_road_map +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>lon, <span class="dt">y=</span>lat),
                                  <span class="dt">data =</span> places_loc, 
                                  <span class="dt">alpha =</span> <span class="fl">0.7</span>, 
                                  <span class="dt">size =</span> <span class="dv">7</span>, 
                                  <span class="dt">color =</span> <span class="st">&quot;tomato&quot;</span>) +<span class="st"> </span>
<span class="st">                       </span><span class="kw">geom_encircle</span>(<span class="kw">aes</span>(<span class="dt">x=</span>lon, <span class="dt">y=</span>lat),
                                     <span class="dt">data =</span> places_loc, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)

<span class="co"># Google Hybrid Map ----------------------------------------</span>
chennai_ggl_hybrid_map +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x=</span>lon, <span class="dt">y=</span>lat),
                                     <span class="dt">data =</span> places_loc, 
                                     <span class="dt">alpha =</span> <span class="fl">0.7</span>, 
                                     <span class="dt">size =</span> <span class="dv">7</span>, 
                                     <span class="dt">color =</span> <span class="st">&quot;tomato&quot;</span>) +<span class="st"> </span>
<span class="st">                          </span><span class="kw">geom_encircle</span>(<span class="kw">aes</span>(<span class="dt">x=</span>lon, <span class="dt">y=</span>lat),
                                        <span class="dt">data =</span> places_loc, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<h3>Open Street Map <a name="Open Street Map"></a></h3>
<p><img src="screenshots/ggplot_masterlist_50.png" alt="Spatial Map in Ggplot2 Ggmap" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3>Google Road Map <a name="Google Road Map"></a></h3>
<p><img src="screenshots/ggplot_masterlist_51.png" alt="Google Road Map in Ggplot2 Ggmap" /></p>
<p><a href="#top">[Back to Top]</a></p>
<h3>Google Hybrid Map <a name="Google Hybrid Map"></a></h3>
<p><img src="screenshots/ggplot_masterlist_52.png" alt="Google Hybrid Map in Ggplot2 Ggmap" /></p>
<p><a href="#top">[Back to Top]</a></p>
<hr />
<p>Have a suggestion or found a bug? Notify <a href="https://docs.google.com/forms/d/e/1FAIpQLSeIJmlvwe562R7JVpi5J2ydLyhk5-7OrGRMFGYrMJvjPal8eA/viewform">here.</a></p>
<p><em><strong>Editors Note:</strong> The <a href="packtpub.com/big-data-and-business-intelligence/mastering-r-programming-video">mastering R programming</a> video course has a dedicated section for ggplot2 where the concepts are demonstrated in detail. Additionally it includes solving real coding challenges at the end of every video lesson.</em></p>
